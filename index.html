<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Seqlm by raivokolde</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Seqlm</h1>
        <p>Sequential lm for methylation data</p>

        <p class="view"><a href="https://github.com/raivokolde/seqlm">View the Project on GitHub <small>raivokolde/seqlm</small></a></p>


        <ul>
          <li><a href="https://github.com/raivokolde/seqlm/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/raivokolde/seqlm/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/raivokolde/seqlm">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="seqlm" class="anchor" href="#seqlm"><span class="octicon octicon-link"></span></a>seqlm</h1>

<p>An R package for identification of differentially methylated regions (DMRs) from high density chip, for example Illumina 450K, data. </p>

<h2>
<a name="method" class="anchor" href="#method"><span class="octicon octicon-link"></span></a>Method</h2>

<p>The seqlm method works in three stages. </p>

<p><strong>Stage 1:</strong> The genome is divided into smaller pieces based on a genomic distance cutoff. </p>

<p><strong>Stage 2:</strong> In each piece probes are segmented into regions that have approximately constant difference between the groups of interest. Example of the segmentation and its process is shown in <a href="https://raw.github.com/raivokolde/seqlm/gh-pages/pics/schema.png" title="Example of seqlm segmentation">schema</a>.</p>

<ul>
<li>In sliding windows with variable sizes we fit a linear models to the data.</li>
<li>For each model we record the description length - the amount of bits needed to describe the data using the model</li>
<li>Using dynamic programming we find the segmentation that minimizes total description length</li>
</ul><p><strong>Stage 3:</strong> We assess the relevance of each segment, by using a mixed model where the classes are a fixed effect and a sample is a random effect. This model takes into account the repeated nature of the consecutive methylation measurements. The segments are ordered by their significance.</p>

<p><img src="https://raw.github.com/raivokolde/seqlm/gh-pages/pics/schema.png" alt="Example of seqlm segmentation" title="Example of seqlm segmentation"></p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>The most convenient way to install the package is by using the <code>devtools</code> package.</p>

<div class="highlight highlight-s"><pre>library<span class="p">(</span>devtools<span class="p">)</span>
install_github<span class="p">(</span><span class="s">"seqlm"</span><span class="p">,</span> <span class="s">"raivokolde"</span><span class="p">)</span>
</pre></div>

<p>To start using the package just load it as any other package.</p>

<div class="highlight highlight-s"><pre>library<span class="p">(</span>seqlm<span class="p">)</span>
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>For running the algorithm one has to have three objects:</p>

<ul>
<li>a matrix with methylation values;</li>
<li>a vector specifying the classes of columns (only two-class case is supported currently);</li>
<li>location information about the methylation probes in GRanges format (a file for Illumina 450K platform can be downloaded from <a href="http://biit.cs.ut.ee/%7Ekolde/seqlm/genome_information.RData">here</a>). </li>
</ul><p>An example dataset <code>tissue_small</code> is included in the package. It contains data comparing adipose tissue and brainstem, from chromosomes 17 and 18. Finding regions in this data can be accomplished using commands:</p>

<div class="highlight highlight-s"><pre>data<span class="p">(</span>tissue_small<span class="p">)</span>
seqlm<span class="p">(</span>values <span class="o">=</span> tissue_small<span class="o">$</span>values<span class="p">,</span> genome_information <span class="o">=</span> tissue_small<span class="o">$</span>genome_information<span class="p">,</span> annotation <span class="o">=</span>  tissue_small<span class="o">$</span>annotation<span class="p">)</span>
</pre></div>

<p>The result of the analysis is a GRanges object containing the locations of the regions and associated statistics. </p>

<p>The analysis can be time consuming, if the whole genome is analysed at once. If the computer has multicore capabilities it is easy to parallelize the calculations. We use the <a href="http://cran.r-project.org/web/packages/foreach/index.html">foreach</a> framework by Revolution Computing for parallelization. To enable the parallelization one has to register the parallel backend before and this will be used by seqlm. Ideally, the next commands should take roughly half the time compared to the previous.</p>

<div class="highlight highlight-s"><pre>library<span class="p">(</span>doParallel<span class="p">)</span>
registerDoParallel<span class="p">(</span>cores <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
seqlm<span class="p">(</span>values <span class="o">=</span> tissue_small<span class="o">$</span>values<span class="p">,</span> genome_information <span class="o">=</span> tissue_small<span class="o">$</span>genome_information<span class="p">,</span> annotation <span class="o">=</span>  tissue_small<span class="o">$</span>annotation<span class="p">)</span>
</pre></div>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/raivokolde">raivokolde</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>